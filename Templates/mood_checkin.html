<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How are you feeling? - MindSpace</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="animated-bg"></div>

    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="/" class="logo">🌟 SereneSpace</a>
                <ul class="nav-links">
                    <li><a href="/dashboard">Dashboard</a></li>
                    <li><a href="/activities">Activities</a></li>
                    <li><a href="/community">Community</a></li>
                    <li><a href="/counseling">Get Help</a></li>
                    <li><a href="/emergency">Emergency</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <div class="card fade-in-up">
                <div class="card-header">
                    <h1 class="card-title">Hey there! 👋</h1>
                    <p class="card-subtitle">
                        Take a moment to check in with yourself. There's no right or wrong answer -
                        just be honest about how you're feeling right now.
                    </p>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <div
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; margin-bottom: 30px;">
                        <h2 style="margin-bottom: 10px;">💙 Your feelings are valid 💙</h2>
                        <p style="opacity: 0.9;">Whatever you're going through, we're here to support you.</p>
                    </div>
                </div>

                <div class="mood-grid">
                    <div class="mood-card" data-mood="stressed">
                        <span class="mood-emoji">😰</span>
                        <div class="mood-label">Stressed</div>
                        <div class="mood-description">Feeling overwhelmed or under pressure</div>
                    </div>

                    <div class="mood-card" data-mood="sad">
                        <span class="mood-emoji">😔</span>
                        <div class="mood-label">Sad</div>
                        <div class="mood-description">Feeling down, low, or upset</div>
                    </div>

                    <div class="mood-card" data-mood="anxious">
                        <span class="mood-emoji">😟</span>
                        <div class="mood-label">Anxious</div>
                        <div class="mood-description">Feeling worried or nervous about things</div>
                    </div>

                    <div class="mood-card" data-mood="lonely">
                        <span class="mood-emoji">😞</span>
                        <div class="mood-label">Lonely</div>
                        <div class="mood-description">Feeling isolated or disconnected</div>
                    </div>

                    <div class="mood-card" data-mood="tired">
                        <span class="mood-emoji">😴</span>
                        <div class="mood-label">Tired</div>
                        <div class="mood-description">Feeling exhausted or burnt out</div>
                    </div>

                    <div class="mood-card" data-mood="okay">
                        <span class="mood-emoji">😐</span>
                        <div class="mood-label">Okay</div>
                        <div class="mood-description">Feeling neutral or just getting by</div>
                    </div>

                    <div class="mood-card" data-mood="happy">
                        <span class="mood-emoji">😊</span>
                        <div class="mood-label">Happy</div>
                        <div class="mood-description">Feeling good and positive</div>
                    </div>

                    <div class="mood-card" data-mood="motivated">
                        <span class="mood-emoji">😤</span>
                        <div class="mood-label">Motivated</div>
                        <div class="mood-description">Feeling energized and ready to tackle things</div>
                    </div>
                </div>

                <div style="text-align: center; margin: 40px 0;">
                    <button id="continueBtn" class="btn btn-primary"
                        style="display: none; font-size: 16px; padding: 12px 30px;">
                        Continue to Your Personalized Support 🌱
                    </button>
                </div>

                <div
                    style="text-align: center; margin-top: 30px; padding: 20px; background: #F0FFF4; border-radius: 15px;">
                    <p style="color: #2D7748; font-weight: 500;">
                        🔒 Your privacy is important to us. All interactions are confidential and secure.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script>
        let selectedMood = null;

        document.addEventListener('DOMContentLoaded', function () {
            const moodCards = document.querySelectorAll('.mood-card');
            const continueBtn = document.getElementById('continueBtn');

            moodCards.forEach(card => {
                card.addEventListener('click', function () {
                    // Remove selected class from all cards
                    moodCards.forEach(c => c.classList.remove('selected'));

                    // Add selected class to clicked card
                    this.classList.add('selected');
                    selectedMood = this.dataset.mood;

                    // Show continue button
                    continueBtn.style.display = 'inline-flex';
                    continueBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                });
            });

            continueBtn.addEventListener('click', function () {
                if (selectedMood) {
                    // Add loading state
                    continueBtn.innerHTML = '<div class="spinner" style="width: 20px; height: 20px; border-width: 2px; margin: 0;"></div> Processing...';
                    continueBtn.disabled = true;

                    // Submit mood selection
                    fetch('/submit-mood', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ mood: selectedMood })
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                // Show encouraging message before redirect
                                showEncouragingMessage(selectedMood);
                                setTimeout(() => {
                                    window.location.href = data.redirect;
                                }, 2000);
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            continueBtn.innerHTML = 'Continue to Your Personalized Support 🌱';
                            continueBtn.disabled = false;
                        });
                }
            });

            // Add entrance animations
            moodCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'all 0.5s ease';

                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        function showEncouragingMessage(mood) {
            const messages = {
                'stressed': 'Breathe in... breathe out. You\'re stronger than you think. Let\'s find some calm together. 🌸',
                'sad': 'Tough days happen, but you matter. Here\'s something uplifting coming your way. 💙',
                'anxious': 'You\'re safe here. Let\'s take one small step at a time to find your peace. 🕊️',
                'lonely': 'You\'re not alone in this journey. There\'s a community waiting to support you. 🤗',
                'tired': 'Rest is not quitting. Let\'s find gentle ways to recharge your energy. 🌙',
                'okay': 'It\'s perfectly fine to feel just okay. Let\'s see what might brighten your day. ✨',
                'happy': 'Your positive energy is wonderful! Let\'s keep that momentum going. 🌟',
                'motivated': 'Love your energy! Let\'s channel that motivation in healthy ways. 🚀'
            };

            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white; padding: 30px; border-radius: 20px; text-align: center;
                box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 10000;
                max-width: 400px; animation: fadeInScale 0.5s ease-out;
            `;

            messageDiv.innerHTML = `
                <h3 style="margin-bottom: 15px; font-size: 20px;">${messages[mood]}</h3>
                <p style="opacity: 0.9;">Preparing your personalized support...</p>
            `;

            // Add CSS for animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeInScale {
                    from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(messageDiv);
        }
    </script>
</body>

</html>