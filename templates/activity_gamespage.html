<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Boosting Activities - MindSpace</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Main CSS for Digital Mental Health App */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #6B73FF;
            --secondary-color: #9BF0E1;
            --accent-color: #FFB4B4;
            --background-light: #F8FBFF;
            --background-card: #FFFFFF;
            --text-primary: #2D3748;
            --text-secondary: #718096;
            --success-color: #48BB78;
            --warning-color: #ED8936;
            --soft-blue: #E6F3FF;
            --soft-green: #F0FFF4;
            --soft-pink: #FFF5F5;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-calm: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --shadow-soft: 0 4px 20px rgba(107, 115, 255, 0.1);
            --shadow-medium: 0 8px 30px rgba(107, 115, 255, 0.15);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background-light);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            opacity: 0.05;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(107, 115, 255, 0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 15px 0;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 20px;
        }

        .nav-links a:hover {
            color: var(--primary-color);
            background: var(--soft-blue);
        }

        .main-content {
            padding-top: 100px;
            min-height: 100vh;
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .card-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .card-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .card {
            background: var(--background-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(107, 115, 255, 0.05);
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .recommendation-card {
            background: var(--background-card);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .recommendation-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 15px rgba(107, 115, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(107, 115, 255, 0.4);
        }

        .btn-soft {
            background: var(--soft-blue);
            color: var(--primary-color);
        }

        .btn-soft:hover {
            background: var(--primary-color);
            color: white;
        }

        .activity-btn {
            background: #F7FAFC;
            border: 1px solid #E2E8F0;
            color: var(--text-primary);
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            width: 100%;
            text-align: left;
        }

        .activity-btn:hover {
            background: var(--soft-blue);
            border-color: var(--primary-color);
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .recommendations-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .main-content {
                padding: 80px 10px 20px;
            }

            .card {
                padding: 20px;
                margin: 15px 0;
            }

            .card-title {
                font-size: 24px;
            }
        }
    </style>
</head>

<body>
    <div class="animated-bg"></div>

    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="/" class="logo">üåü SereneSpace</a>
                <ul class="nav-links">
                    <li><a href="/dashboard">Dashboard</a></li>
                    <li><a href="/activities">Activities</a></li>
                    <li><a href="/community">Community</a></li>
                    <li><a href="/counseling">Get Help</a></li>
                    <li><a href="/emergency">Emergency</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <div class="welcome-section">
                <h1 class="card-title">Fun Activities to Boost Your Mood üéÆ</h1>
                <p class="card-subtitle">
                    Sometimes the best medicine is a little fun! Choose from stress-busting games,
                    creative activities, and mood-lifting exercises designed just for you.
                </p>
            </div>

            <div
                style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 25px; border-radius: 20px; margin: 30px 0; text-align: center;">
                <h2 style="color: #2D3748; margin-bottom: 15px;">üéØ Activity Picker</h2>
                <p style="color: #4A5568; margin-bottom: 20px;">Not sure what you need? Let us suggest something perfect
                    for your current mood!</p>
                <button onclick="getRandomActivity()" class="btn btn-primary" style="font-size: 16px;">
                    üé≤ Surprise Me With Something Fun!
                </button>
            </div>

            <div class="recommendations-grid">
                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <div class="recommendation-icon" style="background: #E6F3FF; color: #3182CE;">üß©</div>
                        <div>
                            <h3>Stress-Busting Games</h3>
                            <p style="color: #718096; font-size: 14px;">Quick games to clear your mind</p>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="playBubblePopper()" class="activity-btn">ü´ß Bubble Pop Therapy</button>
                        <button onclick="playColorMatch()" class="activity-btn">üé® Color Matching Game</button>
                        <button onclick="playMemoryCards()" class="activity-btn">üß† Memory Challenge</button>
                        <button onclick="playBreathingGame()" class="activity-btn">üå¨Ô∏è Breathing Rhythm Game</button>
                    </div>
                </div>

                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <div class="recommendation-icon" style="background: #F0FFF4; color: #38A169;">üé®</div>
                        <div>
                            <h3>Creative Expression</h3>
                            <p style="color: #718096; font-size: 14px;">Let your creativity flow</p>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="openDigitalCanvas()" class="activity-btn">üñåÔ∏è Digital Drawing Canvas</button>
                        <button onclick="startGratitudeJournal()" class="activity-btn">üìù Gratitude Journal</button>
                        <button onclick="createMoodCollage()" class="activity-btn">üñºÔ∏è Mood Vision Board</button>
                        <button onclick="writePositiveAffirmations()" class="activity-btn">üí≠ Positive
                            Affirmations</button>
                    </div>
                </div>

                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <div class="recommendation-icon" style="background: #FFF5F5; color: #E53E3E;">üèÉ‚Äç‚ôÇÔ∏è</div>
                        <div>
                            <h3>Movement & Energy</h3>
                            <p style="color: #718096; font-size: 14px;">Get your body moving</p>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="startDeskStretches()" class="activity-btn">üßò‚Äç‚ôÄÔ∏è Desk Stretches</button>
                        <button onclick="playDanceChallenge()" class="activity-btn">üíÉ 2-Minute Dance Party</button>
                        <button onclick="guidedWalkingExercise()" class="activity-btn">üö∂‚Äç‚ôÇÔ∏è Mindful Walking
                            Guide</button>
                        <button onclick="energyBoostWorkout()" class="activity-btn">‚ö° Quick Energy Booster</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 style="color: #2D3748; margin-bottom: 25px; text-align: center;">üéØ Daily Challenges</h3>
                <div id="dailyChallenges"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                </div>
            </div>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin: 40px 0;">
                <div class="card">
                    <h3 style="color: #2D3748; margin-bottom: 20px;">üéµ Music Therapy Corner</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Music has the power to instantly shift your mood.
                        Try our curated playlists designed to help you feel better.</p>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="playMusicTherapy('calm')" class="activity-btn">üßò‚Äç‚ôÄÔ∏è Calming Nature
                            Sounds</button>
                        <button onclick="playMusicTherapy('happy')" class="activity-btn">üòä Upbeat Mood Lifters</button>
                        <button onclick="playMusicTherapy('focus')" class="activity-btn">üéØ Focus & Study
                            Sounds</button>
                        <button onclick="playMusicTherapy('sleep')" class="activity-btn">üí§ Sleep & Relaxation</button>
                    </div>
                </div>

                <div class="card">
                    <h3 style="color: #2D3748; margin-bottom: 20px;">üì± Quick Mood Boosters</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">30-second activities you can do right now, wherever
                        you are.</p>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="showCompliment()" class="activity-btn">üëç Get a Personal Compliment</button>
                        <button onclick="showFunnyJoke()" class="activity-btn">üòÑ Hear a Funny Joke</button>
                        <button onclick="showInspirationalQuote()" class="activity-btn">‚ú® Inspirational Quote</button>
                        <button onclick="virtualHug()" class="activity-btn">ü§ó Virtual Hug</button>
                    </div>
                </div>
            </div>

            <div class="card" style="text-align: center;">
                <h3 style="color: #2D3748; margin-bottom: 20px;">üèÜ Your Progress</h3>
                <div id="activityStats"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 25px 0;">
                    <div style="background: #E6F3FF; padding: 20px; border-radius: 15px;">
                        <div style="font-size: 24px; font-weight: bold; color: #3182CE;" id="activitiesCompleted">0
                        </div>
                        <div style="color: #4A5568; font-size: 14px;">Activities Completed</div>
                    </div>
                    <div style="background: #F0FFF4; padding: 20px; border-radius: 15px;">
                        <div style="font-size: 24px; font-weight: bold; color: #38A169;" id="streakCount">0</div>
                        <div style="color: #4A5568; font-size: 14px;">Day Streak</div>
                    </div>
                    <div style="background: #FFF5F5; padding: 20px; border-radius: 15px;">
                        <div style="font-size: 24px; font-weight: bold; color: #E53E3E;" id="moodImprovement">+0</div>
                        <div style="color: #4A5568; font-size: 14px;">Mood Points</div>
                    </div>
                </div>
                <p style="color: #718096; font-size: 14px;">Keep engaging with activities to build your wellness streak!
                </p>
            </div>

            <div style="text-align: center; margin: 40px 0;">
                <a href="/dashboard" class="btn btn-soft">‚Üê Back to Dashboard</a>
            </div>
        </div>
    </main>

    <div id="gameModal" style="display: none;"></div>

    <script>
        let activityStats = JSON.parse(localStorage.getItem('mindspace_activity_stats') || '{"completed": 0, "streak": 0, "moodPoints": 0}');

        const dailyChallenges = [
            { icon: "üå±", title: "Gratitude Challenge", description: "Write down 3 things you're grateful for today", reward: "+5 mood points" },
            { icon: "üéµ", title: "Music Mood Boost", description: "Listen to your favorite uplifting song", reward: "+3 mood points" },
            { icon: "üö∂‚Äç‚ôÄÔ∏è", title: "Mindful Walk", description: "Take a 5-minute walk and notice your surroundings", reward: "+4 mood points" },
            { icon: "ü§ù", title: "Connection Challenge", description: "Send a kind message to someone you care about", reward: "+6 mood points" }
        ];

        document.addEventListener('DOMContentLoaded', function () {
            loadDailyChallenges();
            updateStatsDisplay();
        });

        function loadDailyChallenges() {
            const container = document.getElementById('dailyChallenges');
            const today = new Date().getDate();
            const challengeCount = 2 + (today % 2);
            const todaysChallenges = [...dailyChallenges].sort(() => 0.5 - Math.random()).slice(0, challengeCount);

            container.innerHTML = todaysChallenges.map(challenge => `
                <div class="challenge-card" style="background: #F7FAFC; padding: 20px; border-radius: 15px; text-align: center;">
                    <div style="font-size: 32px; margin-bottom: 10px;">${challenge.icon}</div>
                    <h4 style="color: #2D3748; margin-bottom: 10px;">${challenge.title}</h4>
                    <p style="color: #4A5568; margin-bottom: 15px; font-size: 14px;">${challenge.description}</p>
                    <div style="color: #38A169; font-weight: 600; margin-bottom: 15px;">${challenge.reward}</div>
                    <button onclick="completeChallenge(event, '${challenge.title}')" class="btn btn-soft">Complete Challenge</button>
                </div>
            `).join('');
        }

        function getRandomActivity() {
            const activities = [
                "Try the bubble popping game - it's surprisingly therapeutic!",
                "Draw something on our digital canvas - express yourself freely!",
                "Do some quick desk stretches to release tension",
                "Listen to calming nature sounds for 2 minutes",
                "Write down one thing you're proud of today",
                "Take 10 deep breaths while focusing on the present moment",
                "Dance to your favorite song for 30 seconds!",
                "Look out the window and name 5 beautiful things you see"
            ];
            const randomActivity = activities[Math.floor(Math.random() * activities.length)];
            showMessage('üé≤ Perfect Activity for You!', randomActivity, 'success');
        }

        function playBubblePopper() {
            createGameModal(`
                <div style="text-align: center; padding: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">ü´ß Bubble Pop Therapy</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Pop the bubbles to release stress! Click or tap as many as you can.</p>
                    <div id="bubbleGame" style="position: relative; width: 400px; height: 300px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); margin: 0 auto; border-radius: 15px; overflow: hidden;"></div>
                    <div style="margin-top: 20px;">
                        <span style="font-size: 18px; color: #3182CE;">Score: <span id="bubbleScore">0</span></span>
                        <span style="font-size: 16px; color: #718096; margin-left: 20px;">Time: <span id="timeLeft">30</span>s</span>
                    </div>
                </div>
            `);
            startBubbleGame();
        }

        function startBubbleGame() {
            const gameArea = document.getElementById('bubbleGame');
            if (!gameArea) return;
            let score = 0;
            let timeLeft = 30;
            let gameActive = true;
            const style = document.createElement('style');
            style.textContent = `@keyframes bubbleFloat { 0% { transform: translateY(0) scale(0.5); opacity: 0; } 10% { opacity: 1; } 100% { transform: translateY(-260px) scale(1); opacity: 0; } } @keyframes scoreFloat { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-30px); opacity: 0; } } @keyframes popEffect { 0% { transform: scale(1); } 50% { transform: scale(1.5); } 100% { transform: scale(0); opacity: 0; } }`;
            document.head.appendChild(style);
            const timer = setInterval(() => {
                timeLeft--;
                const timeElement = document.getElementById('timeLeft');
                if (timeElement) timeElement.textContent = timeLeft;
                if (timeLeft <= 0) {
                    gameActive = false;
                    clearInterval(timer);
                    clearInterval(bubbleInterval);
                    endBubbleGame(score, style);
                }
            }, 1000);
            const bubbleInterval = setInterval(() => {
                if (gameActive) createBubble();
            }, 600);
            function createBubble() {
                const bubble = document.createElement('div');
                const size = 30 + Math.random() * 20;
                const colors = ['rgba(107,115,255,0.7)', 'rgba(72,187,120,0.7)', 'rgba(237,137,54,0.7)', 'rgba(159,122,234,0.7)'];
                bubble.style.cssText = `position: absolute; width: ${size}px; height: ${size}px; background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, ${colors[Math.floor(Math.random() * colors.length)]} 100%); border-radius: 50%; cursor: pointer; animation: bubbleFloat 4s ease-in-out; left: ${Math.random() * (400 - size)}px; top: 260px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);`;
                bubble.addEventListener('click', () => {
                    if (!gameActive) return;
                    const points = Math.ceil(size / 5);
                    score += points;
                    document.getElementById('bubbleScore').textContent = score;
                    bubble.style.animation = 'popEffect 0.3s ease-out forwards';
                    const scoreText = document.createElement('div');
                    scoreText.textContent = `+${points}`;
                    scoreText.style.cssText = `position: absolute; left: ${bubble.style.left}; top: ${bubble.style.top}; color: #38A169; font-weight: bold; font-size: 16px; animation: scoreFloat 1s ease-out forwards; pointer-events: none; z-index: 10;`;
                    gameArea.appendChild(scoreText);
                    setTimeout(() => { bubble.remove(); scoreText.remove(); }, 300);
                });
                gameArea.appendChild(bubble);
                setTimeout(() => { if (bubble.parentNode) bubble.remove(); }, 4000);
            }
        }

        function endBubbleGame(score, styleElement) {
            const gameArea = document.getElementById('bubbleGame');
            if (gameArea) {
                gameArea.innerHTML = `<div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; color: white;"><h3 style="margin-bottom: 10px;">üéâ Game Over!</h3><p style="font-size: 20px; margin-bottom: 15px;">Final Score: ${score}</p><p style="opacity: 0.9;">${score > 100 ? 'Amazing! You\'re a bubble-popping master!' : score > 50 ? 'Great job! You\'re feeling better already!' : 'Every bubble counts! You did wonderfully!'}</p></div>`;
            }
            setTimeout(() => {
                completeActivity('Bubble Pop Therapy', Math.min(Math.floor(score / 10), 20));
                styleElement.remove();
            }, 3000);
        }

        function playColorMatch() {
            createGameModal(`
                <div style="text-align: center; padding: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üé® Color Matching Game</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Match the colors to clear your mind and focus!</p>
                    <div id="colorGrid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 320px; margin: 0 auto;"></div>
                    <div style="margin-top: 20px;"><span style="font-size: 18px; color: #3182CE;">Matches: <span id="colorScore">0</span>/8</span><span style="font-size: 16px; color: #718096; margin-left: 20px;">Moves: <span id="moveCount">0</span></span></div>
                </div>
            `);
            startColorMatchGame();
        }

        function startColorMatchGame() {
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'];
            const gameColors = [...colors, ...colors].sort(() => Math.random() - 0.5);
            const grid = document.getElementById('colorGrid');
            let flippedCards = []; let matches = 0; let moves = 0; let lockBoard = false;
            gameColors.forEach((color, index) => {
                const card = document.createElement('div');
                card.style.cssText = `width: 70px; height: 70px; background: linear-gradient(135deg, #E2E8F0, #CBD5E0); border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.1);`;
                card.dataset.color = color; card.dataset.index = index;
                card.addEventListener('click', () => {
                    if (lockBoard || card.classList.contains('flipped') || card.classList.contains('matched')) return;
                    card.style.background = `linear-gradient(135deg, ${color}, ${color}dd)`;
                    card.classList.add('flipped');
                    flippedCards.push(card);
                    if (flippedCards.length === 2) {
                        moves++; document.getElementById('moveCount').textContent = moves; lockBoard = true;
                        if (flippedCards[0].dataset.color === flippedCards[1].dataset.color) {
                            matches++; document.getElementById('colorScore').textContent = matches;
                            flippedCards.forEach(c => { c.classList.add('matched'); c.style.transform = 'scale(1.1)'; c.style.boxShadow = '0 4px 20px rgba(72, 187, 120, 0.4)'; });
                            flippedCards = []; lockBoard = false;
                            if (matches === 8) {
                                setTimeout(() => { const bonus = Math.max(20 - moves, 5); completeActivity('Color Matching Game', bonus); }, 1000);
                            }
                        } else {
                            setTimeout(() => { flippedCards.forEach(c => { c.style.background = 'linear-gradient(135deg, #E2E8F0, #CBD5E0)'; c.classList.remove('flipped'); }); flippedCards = []; lockBoard = false; }, 1000);
                        }
                    }
                });
                grid.appendChild(card);
            });
        }

        function playMemoryCards() {
            createGameModal(`
                <div style="text-align: center; padding: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üß† Memory Challenge</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Watch the sequence and repeat it back!</p>
                    <div id="memoryGame" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 250px; margin: 0 auto;">
                        ${Array.from({ length: 9 }).map((_, i) => `<div class="memory-button" data-id="${i}"></div>`).join('')}
                    </div>
                    <div style="margin-top: 20px;">
                        <div style="font-size: 18px; color: #3182CE; margin-bottom: 10px;">Level: <span id="memoryLevel">1</span></div>
                        <div id="memoryStatus" style="font-size: 16px; color: #718096;">Press Start to Begin!</div>
                        <button id="memoryStart" onclick="startMemoryGame()" class="btn btn-primary" style="margin-top: 15px;">Start Game</button>
                    </div>
                </div>
            `);
            setupMemoryGame();
        }

        function setupMemoryGame() {
            const style = document.createElement('style');
            style.textContent = `.memory-button { width: 70px; height: 70px; background: linear-gradient(135deg, #E2E8F0, #CBD5E0); border-radius: 12px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1); } .memory-button.active { background: linear-gradient(135deg, #6B73FF, #9F7AEA) !important; transform: scale(1.1); box-shadow: 0 4px 20px rgba(107, 115, 255, 0.4); } .memory-button:hover { transform: scale(1.05); }`;
            document.head.appendChild(style);
            window.memoryGameStyle = style;
        }

        function startMemoryGame() {
            const buttons = document.querySelectorAll('.memory-button'); const startButton = document.getElementById('memoryStart'); const statusEl = document.getElementById('memoryStatus');
            let sequence = []; let playerSequence = []; let level = 1; let isPlaying = false; let isPlayerTurn = false;
            startButton.style.display = 'none'; statusEl.textContent = 'Watch carefully...';
            function addToSequence() {
                sequence.push(Math.floor(Math.random() * 9)); document.getElementById('memoryLevel').textContent = level; playSequence();
            }
            function playSequence() {
                isPlaying = true; isPlayerTurn = false; let index = 0;
                const interval = setInterval(() => {
                    if (index > 0) buttons[sequence[index - 1]].classList.remove('active');
                    if (index < sequence.length) { buttons[sequence[index]].classList.add('active'); index++; }
                    else { clearInterval(interval); setTimeout(() => { buttons[sequence[sequence.length - 1]].classList.remove('active'); isPlaying = false; isPlayerTurn = true; playerSequence = []; statusEl.textContent = 'Your turn!'; }, 600); }
                }, 600);
            }
            buttons.forEach((button, index) => {
                button.onclick = () => { // Use onclick to clear previous listeners
                    if (!isPlayerTurn || isPlaying) return;
                    button.classList.add('active'); setTimeout(() => button.classList.remove('active'), 200);
                    playerSequence.push(index);
                    if (playerSequence.length === sequence.length) {
                        const correct = playerSequence.every((val, i) => val === sequence[i]); isPlayerTurn = false;
                        if (correct) {
                            level++; statusEl.textContent = 'Correct! Next level...';
                            setTimeout(() => { if (level <= 10) addToSequence(); else { completeActivity('Memory Challenge', level * 5); window.memoryGameStyle.remove(); } }, 1000);
                        } else {
                            statusEl.textContent = 'Game over! Try again.';
                            setTimeout(() => { completeActivity('Memory Challenge', (level - 1) * 3); window.memoryGameStyle.remove(); }, 1500);
                        }
                    } else if (playerSequence[playerSequence.length - 1] !== sequence[playerSequence.length - 1]) {
                        isPlayerTurn = false; statusEl.textContent = 'Game over! Try again.';
                        setTimeout(() => { completeActivity('Memory Challenge', (level - 1) * 3); window.memoryGameStyle.remove(); }, 1500);
                    }
                };
            });
            addToSequence();
        }

        function playBreathingGame() {
            createGameModal(`
                <div style="text-align: center; padding: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üå¨Ô∏è Breathing Rhythm Game</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Follow the circle and breathe in sync for ultimate relaxation!</p>
                    <div id="breathingCircle" style="width: 200px; height: 200px; border-radius: 50%; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); margin: 0 auto; display: flex; align-items: center; justify-content: center; position: relative; box-shadow: 0 10px 30px rgba(107, 115, 255, 0.2); transition: transform 4s ease-in-out;">
                        <div id="breathingText" style="font-size: 24px; font-weight: 600; color: white; z-index: 10;">Get Ready</div>
                    </div>
                    <div style="margin-top: 20px;"><div style="font-size: 18px; color: #3182CE; margin-bottom: 10px;">Cycles: <span id="breathingCycles">0</span></div><button id="startBreathing" onclick="startBreathingSession()" class="btn btn-primary">Start Breathing</button></div>
                </div>
            `);
        }

        function startBreathingSession() {
            const circle = document.getElementById('breathingCircle'); const text = document.getElementById('breathingText'); const cyclesElement = document.getElementById('breathingCycles'); const startButton = document.getElementById('startBreathing');
            let cycles = 0; let isActive = true;
            startButton.style.display = 'none';
            function breatheCycle() {
                if (!isActive || !document.getElementById('breathingCircle')) return;
                text.textContent = 'Breathe In'; text.style.color = '#48BB78'; circle.style.transform = 'scale(1.3)';
                setTimeout(() => {
                    if (!isActive || !document.getElementById('breathingCircle')) return;
                    text.textContent = 'Hold'; text.style.color = '#4299E1';
                    setTimeout(() => {
                        if (!isActive || !document.getElementById('breathingCircle')) return;
                        text.textContent = 'Breathe Out'; text.style.color = '#9F7AEA'; circle.style.transform = 'scale(1)';
                        setTimeout(() => {
                            if (!isActive || !document.getElementById('breathingCircle')) return;
                            cycles++; cyclesElement.textContent = cycles;
                            if (cycles < 5) { setTimeout(breatheCycle, 1000); }
                            else { text.textContent = 'Complete! üåü'; text.style.color = '#48BB78'; setTimeout(() => completeActivity('Breathing Rhythm Game', 15), 2000); }
                        }, 4000);
                    }, 4000);
                }, 4000);
            }
            breatheCycle();
        }

        function openDigitalCanvas() {
            createGameModal(`
                <div style="text-align: center; padding: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üñåÔ∏è Express Yourself</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Draw whatever comes to mind. There's no right or wrong - just express!</p>
                    <div style="margin-bottom: 15px;">${['#6B73FF', '#48BB78', '#ED8936', '#9F7AEA', '#E53E3E'].map(c => `<button onclick="changeColor('${c}')" style="background: ${c}; width: 30px; height: 30px; border: none; border-radius: 50%; margin: 0 5px; cursor: pointer;"></button>`).join('')}</div>
                    <canvas id="drawingCanvas" width="400" height="300" style="border: 2px solid #E2E8F0; border-radius: 10px; cursor: crosshair; background: white;"></canvas>
                    <div style="margin-top: 15px;"><button onclick="clearCanvas()" class="btn btn-soft" style="margin-right: 10px;">Clear</button><button onclick="completeActivity('Digital Drawing', 15)" class="btn btn-primary">Save Artwork</button></div>
                </div>
            `);
            setupCanvas();
        }

        function setupCanvas() {
            const canvas = document.getElementById('drawingCanvas'); const ctx = canvas.getContext('2d'); let isDrawing = false; let currentColor = '#6B73FF';
            ctx.lineWidth = 3; ctx.lineCap = 'round'; ctx.strokeStyle = currentColor;
            window.changeColor = (color) => { currentColor = color; ctx.strokeStyle = color; };
            const startDrawing = (e) => { isDrawing = true; draw(e); }; const stopDrawing = () => { isDrawing = false; ctx.beginPath(); };
            const draw = (e) => {
                if (!isDrawing) return; const rect = canvas.getBoundingClientRect(); const x = (e.clientX || (e.touches && e.touches[0].clientX)) - rect.left; const y = (e.clientY || (e.touches && e.touches[0].clientY)) - rect.top;
                ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
            };
            canvas.addEventListener('mousedown', startDrawing); canvas.addEventListener('mouseup', stopDrawing); canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startDrawing(e); }); canvas.addEventListener('touchend', (e) => { e.preventDefault(); stopDrawing(); }); canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });
            window.clearCanvas = () => ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function startGratitudeJournal() {
            createGameModal(`
                <div style="text-align: center; padding: 30px; max-width: 500px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üìù Gratitude Journal</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Take a moment to reflect on the good things in your life. What are you grateful for today?</p>
                    <div style="text-align: left;"><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px; color: #2D3748; font-weight: 500;">1. I'm grateful for...</label><textarea id="gratitude1" placeholder="Something you're thankful for" style="width: 100%; padding: 10px; border: 2px solid #E2E8F0; border-radius: 8px; resize: none; height: 60px;"></textarea></div><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px; color: #2D3748; font-weight: 500;">2. Today I appreciated...</label><textarea id="gratitude2" placeholder="A moment or person you appreciated" style="width: 100%; padding: 10px; border: 2px solid #E2E8F0; border-radius: 8px; resize: none; height: 60px;"></textarea></div><div style="margin-bottom: 20px;"><label style="display: block; margin-bottom: 5px; color: #2D3748; font-weight: 500;">3. Something positive about myself...</label><textarea id="gratitude3" placeholder="A positive quality or achievement" style="width: 100%; padding: 10px; border: 2px solid #E2E8F0; border-radius: 8px; resize: none; height: 60px;"></textarea></div></div>
                    <button onclick="saveGratitudeJournal()" class="btn btn-primary">Save My Gratitude üåü</button>
                </div>
            `);
        }

        function saveGratitudeJournal() {
            const entry1 = document.getElementById('gratitude1').value; const entry2 = document.getElementById('gratitude2').value; const entry3 = document.getElementById('gratitude3').value;
            if (entry1.trim() || entry2.trim() || entry3.trim()) { completeActivity('Gratitude Journal', 20); }
            else { showMessage('üí≠ Keep Writing', 'Try filling in at least one gratitude entry to get the full benefit!', 'info'); }
        }

        function writePositiveAffirmations() {
            const affirmations = ["I am capable of handling whatever comes my way", "I choose to focus on what I can control", "I am worthy of love and respect", "Every challenge helps me grow stronger", "I trust in my ability to make good decisions", "I am grateful for this moment and opportunity to grow", "I have the power to create positive change in my life", "I choose peace and calm in my heart and mind"];
            createGameModal(`
                <div style="text-align: center; padding: 30px; max-width: 500px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üí≠ Positive Affirmations</h3>
                    <p style="margin-bottom: 25px; color: #4A5568;">Read these affirmations aloud or silently. Let them sink in and believe in their truth.</p>
                    <div id="affirmationList" style="text-align: left; margin-bottom: 25px;">
                        ${affirmations.map((affirmation, index) => `<div style="background: #F7FAFC; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid #6B73FF;"><input type="checkbox" id="affirmation${index}" onchange="checkAffirmation()" style="margin-right: 10px;"><label for="affirmation${index}" style="color: #2D3748; cursor: pointer;">${affirmation}</label></div>`).join('')}
                    </div>
                    <div style="margin-bottom: 20px;"><label style="display: block; margin-bottom: 5px; color: #2D3748; font-weight: 500;">Write your own affirmation:</label><textarea id="customAffirmation" placeholder="I am..." style="width: 100%; padding: 10px; border: 2px solid #E2E8F0; border-radius: 8px; resize: none; height: 60px;"></textarea></div>
                    <button onclick="finishAffirmations()" class="btn btn-primary" id="finishAffirmationsBtn" disabled>Complete Session ‚ú®</button>
                </div>
            `);
        }

        function checkAffirmation() {
            const checkedCount = Array.from(document.querySelectorAll('#affirmationList input[type="checkbox"]:checked')).length;
            const finishBtn = document.getElementById('finishAffirmationsBtn');
            if (checkedCount >= 3) { finishBtn.disabled = false; finishBtn.style.opacity = '1'; }
        }

        function finishAffirmations() {
            const customAffirmation = document.getElementById('customAffirmation').value; const bonus = customAffirmation.trim() ? 5 : 0;
            completeActivity('Positive Affirmations', 15 + bonus);
        }

        function playMusicTherapy(type) {
            const messages = { 'calm': 'Playing peaceful nature sounds to help you relax and unwind. üåø', 'happy': 'Starting upbeat melodies to lift your spirits and energize your day! üéµ', 'focus': 'Beginning focus-enhancing sounds to help you concentrate. üéØ', 'sleep': 'Starting gentle sleep sounds to help you wind down. üò¥' };
            showMessage('üéµ Music Therapy', messages[type], 'success'); completeActivity(`Music Therapy - ${type}`, 8);
        }

        function showCompliment() {
            const compliments = ["You have incredible strength for reaching out. That takes real courage! üí™", "Your commitment to your mental health is inspiring. ‚ú®", "You're making positive changes, and that's something to be proud of! üåü", "You're braver than you believe and stronger than you think! üíô", "The fact that you're here shows how much you care about yourself. That's beautiful! üå∏", "You're taking steps toward wellness, and every step matters. Keep going! üéØ"];
            showMessage('üëç A Message for You', compliments[Math.floor(Math.random() * compliments.length)], 'success'); completeActivity('Received Compliment', 5);
        }

        function showFunnyJoke() {
            const jokes = ["Why don't scientists trust atoms? Because they make up everything! üòÑ", "What do you call a bear with no teeth? A gummy bear! üêª", "Why did the coffee file a police report? It got mugged! ‚òï", "What do you call a dinosaur that crashes his car? Tyrannosaurus Wrecks! ü¶ï", "Why don't eggs tell jokes? They'd crack each other up! ü•ö"];
            showMessage('üòÑ Joke Time!', jokes[Math.floor(Math.random() * jokes.length)], 'info'); completeActivity('Heard a Joke', 3);
        }

        function showInspirationalQuote() {
            const quotes = ['"The secret of getting ahead is getting started." ‚Äî Mark Twain', '"You are braver than you believe, stronger than you seem, and smarter than you think." ‚Äî A.A. Milne', '"The only way to do great work is to love what you do." ‚Äî Steve Jobs', '"Life is 10% what happens to you and 90% how you react to it." ‚Äî Charles R. Swindoll', '"Success is not final, failure is not fatal: it is the courage to continue that counts." ‚Äî Winston Churchill'];
            showMessage('‚ú® Inspiration', quotes[Math.floor(Math.random() * quotes.length)], 'info'); completeActivity('Read a Quote', 3);
        }

        function virtualHug() {
            const hugModal = document.createElement('div');
            hugModal.style.cssText = `position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center;`;
            hugModal.innerHTML = `<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 50px; border-radius: 30px; text-align: center; animation: hugPulse 2s ease-in-out;"><div style="font-size: 80px; margin-bottom: 20px; animation: hugBounce 1.5s ease-in-out infinite;">ü§ó</div><h3 style="margin-bottom: 15px; font-size: 28px;">Sending You a Big Hug!</h3><p style="opacity: 0.9; font-size: 18px; margin-bottom: 25px;">You are cared for, valued, and not alone.</p><button onclick="this.closest('div').parentElement.remove(); completeActivity('Virtual Hug', 8);" class="btn" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 12px 24px; border-radius: 25px; cursor: pointer;">Thank you ‚ù§Ô∏è</button></div>`;
            const style = document.createElement('style'); style.textContent = `@keyframes hugPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } } @keyframes hugBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }`;
            document.head.appendChild(style); document.body.appendChild(hugModal);
            setTimeout(() => { if (hugModal.parentNode) { hugModal.remove(); style.remove(); } }, 10000);
        }

        function startDeskStretches() { showMessage('üßò‚Äç‚ôÄÔ∏è Desk Stretches', 'Great choice! Try shoulder rolls, neck stretches, and gentle twists. Your body will thank you!', 'success'); completeActivity('Desk Stretches', 10); }
        function playDanceChallenge() { showMessage('üíÉ Dance Party', 'Time to move! Put on your favorite song and dance like nobody\'s watching for 2 minutes!', 'success'); completeActivity('Dance Challenge', 12); }
        function guidedWalkingExercise() { showMessage('üö∂‚Äç‚ôÇÔ∏è Mindful Walk', 'Perfect! Take a slow walk and notice 5 things you can see, 4 you can hear, 3 you can feel, 2 you can smell, and 1 you can taste.', 'success'); completeActivity('Mindful Walking', 15); }
        function energyBoostWorkout() { showMessage('‚ö° Energy Booster', 'Let\'s energize! Try 10 jumping jacks, 5 push-ups, and 30 seconds of marching in place. You\'ve got this!', 'success'); completeActivity('Energy Workout', 15); }

        function createMoodCollage() {
            createGameModal(`
                <div style="text-align: center; padding: 30px; max-width: 600px;">
                    <h3 style="margin-bottom: 20px; color: #2D3748;">üñºÔ∏è Mood Vision Board</h3>
                    <p style="margin-bottom: 20px; color: #4A5568;">Create a visual representation of your goals, dreams, and positive feelings!</p>
                    <div id="moodBoard" style="width: 400px; height: 300px; border: 2px dashed #CBD5E0; border-radius: 15px; margin: 0 auto 20px; position: relative; background: linear-gradient(45deg, #f8f9ff 25%, transparent 25%), linear-gradient(-45deg, #f8f9ff 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #f8f9ff 75%), linear-gradient(-45deg, transparent 75%, #f8f9ff 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                        <div style="font-size: 48px; opacity: 0.5; margin-bottom: 10px;">üé®</div>
                        <p style="color: #718096; font-size: 14px;">Click below to add elements to your vision board</p>
                    </div>
                    <div style="margin-bottom: 20px;">
                        ${['üåü', 'üíé', 'üåà', 'ü¶ã', 'üå∏', 'üöÄ', '‚ù§Ô∏è', 'üèÜ'].map(emoji => `<button onclick="addMoodElement('${emoji}')" style="background: #F7FAFC; border: 1px solid #E2E8F0; padding: 10px; border-radius: 8px; margin: 5px; cursor: pointer; font-size: 20px; transition: transform 0.2s ease;">${emoji}</button>`).join('')}
                    </div>
                    <button onclick="saveMoodBoard()" class="btn btn-primary">Save My Vision Board ‚ú®</button>
                </div>
            `);
        }

        function addMoodElement(emoji) {
            const board = document.getElementById('moodBoard');
            if (board.querySelector('p')) board.innerHTML = '';
            const element = document.createElement('div');
            element.textContent = emoji;
            element.style.cssText = `position: absolute; font-size: 32px; cursor: move; user-select: none; left: ${Math.random() * (board.clientWidth - 40)}px; top: ${Math.random() * (board.clientHeight - 40)}px;`;
            let isDragging = false;
            element.onmousedown = (e) => {
                isDragging = true;
                let shiftX = e.clientX - element.getBoundingClientRect().left; let shiftY = e.clientY - element.getBoundingClientRect().top;
                function moveAt(pageX, pageY) {
                    element.style.left = pageX - board.getBoundingClientRect().left - shiftX + 'px';
                    element.style.top = pageY - board.getBoundingClientRect().top - shiftY + 'px';
                }
                function onMouseMove(event) { if (isDragging) moveAt(event.pageX, event.pageY); }
                document.addEventListener('mousemove', onMouseMove);
                element.onmouseup = () => { isDragging = false; document.removeEventListener('mousemove', onMouseMove); element.onmouseup = null; };
            };
            element.ondragstart = () => false;
            board.appendChild(element);
        }

        function saveMoodBoard() {
            completeActivity('Mood Vision Board', 18);
        }

        // --- Core Utility Functions ---
        function createGameModal(content) {
            const modal = document.getElementById('gameModal');
            modal.style.cssText = `position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center;`;
            modal.style.display = 'flex';
            modal.innerHTML = `<div style="background: white; border-radius: 20px; position: relative; max-width: 90vw; max-height: 90vh; overflow-y: auto;"><button onclick="closeGameModal()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 24px; cursor: pointer; color: #718096;">&times;</button>${content}</div>`;
        }

        function closeGameModal() {
            const modal = document.getElementById('gameModal');
            if (modal) { modal.style.display = 'none'; modal.innerHTML = ''; }
        }

        function completeActivity(activityName, points = 10) {
            if (document.getElementById('gameModal')?.style.display !== 'none') closeGameModal();
            activityStats.completed++;
            activityStats.moodPoints += Math.round(points);
            updateStatsDisplay();
            saveActivityStats();
            showMessage('üéâ Activity Completed!', `Great job on ${activityName}! You earned ${Math.round(points)} mood points.`, 'success');
        }

        function completeChallenge(event, challengeName) {
            const points = Math.floor(Math.random() * 4) + 3;
            activityStats.completed++;
            activityStats.moodPoints += points;
            updateStatsDisplay();
            saveActivityStats();
            showMessage('üéâ Challenge Done!', `Awesome work on the ${challengeName}! You earned ${points} mood points.`, 'success');
            event.target.innerHTML = '‚úÖ Completed!';
            event.target.disabled = true;
            event.target.style.background = '#48BB78';
            event.target.style.color = 'white';
        }

        function updateStatsDisplay() {
            document.getElementById('activitiesCompleted').textContent = activityStats.completed;
            document.getElementById('streakCount').textContent = activityStats.streak;
            document.getElementById('moodImprovement').textContent = `+${activityStats.moodPoints}`;
        }

        function saveActivityStats() {
            localStorage.setItem('mindspace_activity_stats', JSON.stringify(activityStats));
        }

        function showMessage(title, message, type) {
            const colors = { success: 'linear-gradient(135deg, #48BB78, #38A169)', info: 'linear-gradient(135deg, #4299E1, #3182CE)', warning: 'linear-gradient(135deg, #ED8936, #DD6B20)' };
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `position: fixed; top: 20px; right: 20px; z-index: 10001; background: ${colors[type] || colors['info']}; color: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); max-width: 350px; animation: slideInRight 0.5s ease-out;`;
            messageDiv.innerHTML = `<h4 style="margin-bottom: 8px; font-size: 16px;">${title}</h4><p style="opacity: 0.9; font-size: 14px; line-height: 1.4;">${message}</p>`;
            const style = document.createElement('style'); style.textContent = `@keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }`;
            document.head.appendChild(style); document.body.appendChild(messageDiv);
            setTimeout(() => { messageDiv.remove(); style.remove(); }, 4000);
        }
    </script>
</body>

</html>